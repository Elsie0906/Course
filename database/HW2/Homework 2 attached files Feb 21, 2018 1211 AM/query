Q1:
SELECT USERS.USER_ID, USERS.NAME FROM USERS WHERE NOT EXISTS(SELECT POSTS.USER_ID FROM POSTS)
AND EXISTS(SELECT COMMENTS.COMMENTER_USER_ID FROM COMMENTS WHERE (COMMENTS.POST_ID=1005) GROUP BY(COMMENTS.COMMENTER_USER_ID) HAVING COUNT(COMMENTS.COMMENT_ID)>=1
AND USERS.USER_ID=COMMENTS.COMMENTER_USER_ID);

Q3:
SELECT USER_ID FROM FRIENDSHIPS GROUP BY (USER_ID) HAVING COUNT(FRIEND_ID)>=2
AND USER_ID IN (
SELECT USER_ID FROM POSTS GROUP BY (USER_ID) HAVING COUNT(POST_ID)>=1);

SELECT DISTINCT USER_ID FROM FRIENDSHIPS WHERE EXISTS (SELECT DISTINCT USER_ID FROM POSTS)
GROUP BY (USER_ID) HAVING COUNT(FRIEND_ID)>=2

->
// error syntax
SELECT DISTINCT FRIENDSHIPS.USER_ID FROM FRIENDSHIPS GROUP BY (FRIENDSHIPS.USER_ID) HAVING COUNT(FRIENDSHIPS.FRIEND_ID)>=2
AND EXISTS(
SELECT POSTS.USER_ID FROM POSTS
AND FRIENDSHIPS.FRIEND_ID = POSTS.USER_ID);


Q5:
SELECT DISTINCT COMMENTS.COMMENTER_USER_ID FROM COMMENTS WHERE (COMMENTS.POST_ID=1007) 

AND EXISTS(

SELECT DISTINCT FRIENDSHIPS.FRIEND_ID FROM FRIENDSHIPS WHERE (FRIENDSHIPS.USER_ID IN (SELECT DISTINCT POSTS.USER_ID FROM POSTS WHERE(POSTS.POST_ID=1007)))

AND COMMENTS.COMMENTER_USER_ID = FRIENDSHIPS.FRIEND_ID)

Q4:
SELECT FRIENDSHIPS.USER_ID, COUNT(FRIENDSHIPS.FRIEND_ID) FROM FRIENDSHIPS 
WHERE FRIENDSHIPS.USER_ID IN (SELECT USERS.USER_ID FROM USERS WHERE (USERS.GENDER="F" AND USERS.DATE_OF_BIRTH > '1990-12-20')
AND EXISTS(SELECT DISTINCT COMMENTS.COMMENTER_USER_ID FROM COMMENTS WHERE COMMENTS.POST_ID IN (SELECT POSTS.POST_ID FROM POSTS WHERE (POSTS.USER_ID=10)) AND USERS.USER_ID = COMMENTS.COMMENTER_USER_ID)) GROUP BY (FRIENDSHIPS.USER_ID)

Q6:
1.USER is a Female:
SELECT USER_ID, NAME FROM USERS WHERE GENDER="F"
2.USER has Friend 20:
SELECT USER_ID FROM FRIENDSHIPS WHERE FRIEND_ID=20

#enlarge the table
SELECT COMMENTS.COMMENT_ID,COMMENTS.COMMENTER_USER_ID,POSTS.USER_ID FROM POSTS INNER JOIN COMMENTS ON POSTS.POST_ID = COMMENTS.POST_ID;
3. Comments do not post by USER itself & 10
SELECT COMMENTS.COMMENT_ID,COMMENTS.COMMENTER_USER_ID,POSTS.USER_ID FROM POSTS INNER JOIN COMMENTS ON (POSTS.POST_ID = COMMENTS.POST_ID) WHERE NOT (COMMENTS.COMMENTER_USER_ID = POSTS.USER_ID OR COMMENTER_USER_ID=10)

4. at least 3 comments in Step3

SELECT COMMENTS.COMMENTER_USER_ID FROM COMMENTS WHERE COMMENTS.COMMENT_ID IN(SELECT COMMENTS.COMMENT_ID FROM POSTS INNER JOIN COMMENTS ON (POSTS.POST_ID = COMMENTS.POST_ID) WHERE NOT (COMMENTS.COMMENTER_USER_ID = POSTS.USER_ID OR COMMENTER_USER_ID=10)) GROUP BY (COMMENTS.COMMENTER_USER_ID) HAVING COUNT(COMMENTS.COMMENT_ID)>=3;

5. total comments
SELECT COMMENTS.COMMENTER_USER_ID,COUNT(COMMENTS.COMMENT_ID) AS TOTAL FROM COMMENTS GROUP BY (COMMENTS.COMMENTER_USER_ID) HAVING COUNT(COMMENTS.COMMENT_ID)>=3;

6. combine Step1 & 2

SELECT DISTINCT T.USER_ID, T.NAME, COUNT(T.COMMENT_ID) AS ACC
FROM (SELECT USERS.USER_ID, USERS.NAME, COMMENTS.COMMENT_ID
FROM USERS
INNER JOIN COMMENTS ON (USERS.USER_ID=COMMENTS.COMMENTER_USER_ID
AND USERS.GENDER="F" 
AND USERS.USER_ID IN (SELECT USER_ID FROM FRIENDSHIPS WHERE FRIEND_ID=20))
AND COMMENTS.COMMENT_ID IN(SELECT COMMENTS.COMMENT_ID FROM POSTS INNER JOIN COMMENTS ON (POSTS.POST_ID = COMMENTS.POST_ID) WHERE NOT (COMMENTS.COMMENTER_USER_ID = POSTS.USER_ID OR COMMENTER_USER_ID=10))) AS T
GROUP BY (T.USER_ID) HAVING COUNT(T.COMMENT_ID)>=3
ORDER BY ACC DESC
LIMIT 3;
















